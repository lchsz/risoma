% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/expr.R
\name{calc_one_tsi}
\alias{calc_one_tsi}
\title{Calculate Tissue Specificity Index (TSI) for a Single Feature}
\usage{
calc_one_tsi(exp)
}
\arguments{
\item{exp}{A numeric data frame representing non-negative expression values
across tissues/conditions (e.g., TPM). Negative values will trigger an error.}
}
\value{
A numeric value between 0 and 1:
 \itemize{
    \item 1: Exclusive expression in one tissue/condition.
    \item 0: Uniform expression across all tissues/conditions.
    \item Returns "NaN" if all values are zero or only one tissue/condition
          is provided.
 }
}
\description{
This function computes the Tissue Specificity Index (TSI) for a gene based on
its expression profile across multiple tissues or conditions. TSI quantifies
how specifically a feature is expressed in a single tissue/condition, with
values ranging from 0 (uniform expression) to 1 (exclusive expression).
}
\details{
The TSI is calculated using the formula:
\deqn{TSI = \frac{\sum_{i=1}^{n} \left(1 - \frac{exp_i}{exp_{\text{max}}}\right)}{n - 1}}
where:
- \eqn{exp_{\text{max}}} is the maximum expression value in the vector.
- \eqn{n} is the number of tissues/conditions.
}
\examples{
# Example 1: Exclusive expression
exp1 <- c(0, 0, 10, 0)
calc_one_tsi(exp1)  # Returns 1

# Example 2: Uniform expression
exp2 <- c(5, 5, 5, 5)
calc_one_tsi(exp2)  # Returns 0

# Example 3: Mixed expression
exp3 <- c(2, 8, 4, 6)
calc_one_tsi(exp3)  # Returns 0.5

# Example 4: Invalid input (negative values)
# exp4 <- c(-1, 3, 5)
# calc_one_tsi(exp4)  # Throws error: "Expression values must be non-negative"

}
